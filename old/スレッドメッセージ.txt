https://157.82.133.212/oednamap
ã§ web ãƒ„ãƒ¼ãƒ«ã‚’èµ°ã‚‰ã›ã‚‹ã¨ã€
Safari é–‹ç™ºè€…ãƒ„ãƒ¼ãƒ«ã®ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã«ã€
[Error] Failed to load resource: the server responded with a status of 504 (Gateway Time-out) (submit, line 0)
ã¨è¨€ã†ã‚¨ãƒ©ãƒ¼ãŒå‡ºã¾ã™ã€‚ã“ã®ã‚¨ãƒ©ãƒ¼ã¯ã€index 42.htmlã«ã‚ã‚‹type="checkbox" name="list_cruiseNames"ã‚’ 7 ã¤ç¨‹åº¦ä»¥ä¸Šé¸ã¶ã¨å‡ºã¦ãã¾ã™ãŒã€4 ã¤ãã‚‰ã„ã¾ã§ã ã¨ã€æ­£å¸¸ã«ã‚¦ã‚§ãƒ–ãƒ„ãƒ¼ãƒ«ãŒçµ‚ã‚ã‚Šã¾ã™ã€‚
ãªãŠã€ã“ã®ã‚¨ãƒ©ãƒ¼ã¯ã€(venv) jinoue@rx1000:~/oednamap$ pytnon3 app.pyã«ã‚ˆã£ã¦ãƒ‡ãƒã‚°ç’°å¢ƒã§å‹•ã‹ã—ã¦ã„ã‚‹éš›ã«ã¯ã€type="checkbox" name="list_cruiseNames"ã‚’ 7 ã¤ç¨‹åº¦ä»¥ä¸Šé¸ã‚“ã§ã‚‚å‡ºã¦ã“ãªã„ã§ã€æ­£å¸¸ã«ã‚¦ã‚§ãƒ–ãƒ„ãƒ¼ãƒ«ãŒçµæœã‚’å‡ºã—ã¾ã™ã€‚


###### è§£æ±ºç­–

# Nginx + uWSGI Timeout Settings for Python Web App Deployment

## ğŸ”§ Nginx Configuration (`/etc/nginx/sites-available/your_site`)

```nginx
location /your_app {
    client_max_body_size 50M;
    include uwsgi_params;
    uwsgi_pass unix:/tmp/your_app.sock;

    # uWSGI ç”¨ã®ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆè¨­å®šï¼ˆé‡è¦ï¼‰
    uwsgi_read_timeout 900;
    uwsgi_send_timeout 900;
}

ãƒã‚¤ãƒ³ãƒˆ
proxy_*_timeout ã¯ uwsgi_pass ã§ã¯ç„¡åŠ¹ã€‚
uwsgi_read_timeout ã¨ uwsgi_send_timeout ã‚’ä½¿ã†ã€‚

# wsgi.in
[uwsgi]
module = app:app
master = true
processes = 4
threads = 2

socket = /tmp/your_app.sock
chmod-socket = 660

virtualenv = /path/to/venv
chdir = /path/to/app

harakiri = 900  # ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆï¼ˆç§’ï¼‰
limit-post = 134217728  # POSTãƒ‡ãƒ¼ã‚¿æœ€å¤§ã‚µã‚¤ã‚ºï¼ˆ128MBï¼‰
buffer-size = 10485760  # ãƒãƒƒãƒ•ã‚¡ã‚µã‚¤ã‚ºï¼ˆ10MBï¼‰

vacuum = true
die-on-term = true



### 
ãƒã‚¤ãƒ³ãƒˆ
harakiri ã¯ uWSGI å´ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆï¼ˆç§’ï¼‰ã€‚
limit-post ã‚„ buffer-size ã‚‚å¤§ãã‚ã«è¨­å®šã€‚

ã‚ˆãã‚ã‚‹ãƒˆãƒ©ãƒ–ãƒ«ã¨å¯¾ç­–
ç—‡çŠ¶	åŸå› 	å¯¾ç­–
504 Gateway Time-out	nginx ã®ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆè¨­å®šä¸è¶³	uwsgi_read_timeout ã‚’è¿½åŠ 

å‡¦ç†ãŒé€”ä¸­ã§æ­¢ã¾ã‚‹	uWSGI ã® harakiri ã«å¼•ã£ã‹ã‹ã‚‹	harakiri ã‚’å»¶é•·

ãƒ•ã‚¡ã‚¤ãƒ«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰å¤±æ•—	client_max_body_size ãŒå°ã•ã„	nginx ã¨ uWSGI ä¸¡æ–¹ã§ã‚µã‚¤ã‚ºã‚’æ‹¡å¤§

JSON ãƒ‘ãƒ¼ã‚¹ã‚¨ãƒ©ãƒ¼	ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãŒ HTML ãªã©ã«ãªã£ã¦ã„ã‚‹	response.json() ã®å‰ã« response.ok ã‚’ç¢ºèª

###
âœ… è¨­å®šå¤‰æ›´å¾Œã®åæ˜ æ‰‹é †
sudo nginx -t
sudo systemctl reload nginx
sudo systemctl restart uwsgi  # ã¾ãŸã¯ uwsgi --ini wsgi.ini
